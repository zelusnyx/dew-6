"use strict";(self.webpackChunkdewui=self.webpackChunkdewui||[]).push([[468],{65702:function(t,e,i){i.r(e),i.d(e,{PublicHLBParserModule:function(){return kt}});var n=i(65939),s=i(3679),r=i(90171),o=i(49983),a=i(93738),c=i(77310),l=i(36858),d=i(39577),u=i(51095),h=i(77001),g=i(22238),b=i(32789),p=i(70721),v=i(37716),f=i(95987),m=i(73969),x=i(68233),Z=i(15062),T=i(38583),C=i(98295);function A(t,e){if(1&t){const t=v.EpF();v.TgZ(0,"div",8),v.TgZ(1,"button",9),v.NdJ("click",function(){return v.CHM(t),v.oxw().save()}),v._uU(2,"Save"),v.qZA(),v.qZA()}}let q=(()=>{class t{constructor(t,e){this.state=t,this.auth=e,this.experiment={userId:this.auth.getCookie("userId"),name:"",description:"",behavior:[],actor:[],binding:[],constraint:[]},this.tokenList=[]}ngOnInit(){null!=this.id&&null!=this.id&&-1!=this.id&&(this.experiment.id=this.id),this.state.getExperimentName().subscribe(t=>{this.experiment.name=t}),this.state.getExperimentDescription().subscribe(t=>{this.experiment.description=t}),this.state.getBehavior().subscribe(t=>{this.experiment.behavior=t}),this.state.getActors().subscribe(t=>{this.experiment.actor=t}),this.state.getBindings().subscribe(t=>{this.experiment.binding=t}),this.state.getConstraints().subscribe(t=>{this.experiment.constraint=t}),this.tokenLevel=this.state.getTokenLevel()}onlyReadable(){return"read"==this.tokenLevel}setExperimentName(){this.state.setExperimentName(this.experiment.name)}setExperimentDescription(){this.state.setExperimentDescription(this.experiment.description)}save(){console.log(this.experiment)}}return t.\u0275fac=function(e){return new(e||t)(v.Y36(x.b),v.Y36(Z.e))},t.\u0275cmp=v.Xpm({type:t,selectors:[["experiment-info"]],inputs:{id:"id"},decls:15,vars:5,consts:[[1,"row"],[1,"col-md-8"],[1,"row",2,"margin","0.5em"],[1,"col-md-12",2,"padding","0"],["appearance","outline",1,"col-md-12"],["matInput","",3,"disabled","ngModel","ngModelChange","change"],[1,"col-md-4"],["style","text-align: center; padding: 1em;",4,"ngIf"],[2,"text-align","center","padding","1em"],["mat-stroked-button","",3,"click"]],template:function(t,e){1&t&&(v.TgZ(0,"div",0),v.TgZ(1,"div",1),v.TgZ(2,"div",2),v.TgZ(3,"div",3),v.TgZ(4,"mat-card"),v.TgZ(5,"mat-form-field",4),v.TgZ(6,"mat-label"),v._uU(7,"Experiment Name"),v.qZA(),v.TgZ(8,"input",5),v.NdJ("ngModelChange",function(t){return e.experiment.name=t})("change",function(){return e.setExperimentName()}),v.qZA(),v.qZA(),v.TgZ(9,"mat-form-field",4),v.TgZ(10,"mat-label"),v._uU(11,"Experiment Description"),v.qZA(),v.TgZ(12,"textarea",5),v.NdJ("ngModelChange",function(t){return e.experiment.description=t})("change",function(){return e.setExperimentDescription()}),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.TgZ(13,"div",6),v.YNc(14,A,3,0,"div",7),v.qZA(),v.qZA()),2&t&&(v.xp6(8),v.Q6J("disabled",e.onlyReadable())("ngModel",e.experiment.name),v.xp6(4),v.Q6J("disabled",e.onlyReadable())("ngModel",e.experiment.description),v.xp6(2),v.Q6J("ngIf",!e.onlyReadable()))},directives:[a.a8,C.KE,C.hX,o.Nt,s.Fj,s.JJ,s.On,T.O5,u.lW],styles:[""]}),t})();var M=i(72161),w=i(26215);class L{constructor(t){this.textData=new w.X(""),this.onBlur=new w.X(!1),this.isEnterPress=new w.X(!1),this.isTabPress=new w.X(!1),this.onBlurFlag=!1,this.currentword=new w.X(""),this.currentsentence=new w.X(null),this.isTextChange=!1,this.index=0,this.quill=t;var e=this;this.quill.on("selection-change",function(t,i,n){t?(e.index=t.index,e.range=t.length,e.onBlurFlag&&(e.onBlur.next(!1),e.onBlurFlag=!1)):(e.onBlurFlag=!0,e.onBlur.next(!0))}),this.quill.on("text-change",function(t,i,n){var s=0,r=!1,o=!1;e.isTextChange=!0,null!=t.ops&&t.ops.forEach(t=>{null!=t.retain&&(s=t.retain),null!=t.insert&&(s+=t.insert.length,"\n"==t.insert&&e.pressedEntered(),"\t"==t.insert&&(r=!0)),null!=t.delete&&(o=!0)});var a=e.quill.getText().length-1,c=e.quill.getText().substr(0,a);e.index=s,r?o||setTimeout(function(){e.pressedTab()},50):(e.currentSentence(c,s),e.currentWord(c,s))})}getUpdatedValue(){return this.textData.asObservable()}getCurrentWord(){return this.currentword.asObservable()}getSuggestionData(){return this.currentsentence.asObservable()}isEnterPressed(){return this.isEnterPress.asObservable()}isTabPressed(){return this.isTabPress.asObservable()}setUpdatedValue(t){this.textData.next(t)}currentWord(t,e){var i=this.getWordAt(t,e);this.currentword.next(i)}currentSentence(t,e){var i=this.getSentenceTill(t,e),n=this.getRemainingSentences(t,e);this.currentsentence.next({currentSentence:i,remainingSentences:n})}getRemainingSentences(t,e){t=String(t),e=Number(e)>>>0;var i,n=t.slice(0,e).search(/\n.*$/),s=[];return n>0&&(i=t.slice(0,n).split("\n")).forEach(t=>{""!=t.trim()&&s.push(t)}),(i=t.slice(n+1).split("\n")).splice(0,1),i.forEach(t=>{""!=t.trim()&&s.push(t)}),s}getWordAt(t,e){t=String(t),e=Number(e)>>>0;var i=t.slice(0,e).search(/\S+$/),n=t.slice(e).search(/\s/);return n<0?t.slice(i):t.slice(i,n+e)}getSentenceTill(t,e){t=String(t),e=Number(e)>>>0;var i=t.slice(0,e).search(/\n.*$/),n=t.slice(e).search(/\s/);return n<0?t.slice(i+1):t.slice(i+1,n+e)}getSentenceAt(t,e){t=String(t),e=Number(e)>>>0;var i=t.slice(0,e).search(/\n.+$/);return t.slice(i+1).split("\n")[0]}isTextChanged(){var t=this.isTextChange;return this.resetTextChangeFlag(),t}resetTextChangeFlag(){this.isTextChange=!1}pressedEntered(){this.isEnterPress.next(!0)}pressedTab(){this.isTabPress.next(!0)}insertValue(t,e=!0,i){""==i.trim()?(e&&(this.index--,this.quill.deleteText(this.index,1)),this.quill.insertText(this.index,t+" ")):this.replaceText(this.quill.getText(),t,i,e)}replaceText(t,e,i,n){var s;t=String(t),s=n?Number(this.index-1)>>>0:Number(this.index)>>>0;var r=t.slice(0,s).search(/\S+$/);this.quill.deleteText(r,n?i.length+1:i.length),this.quill.insertText(r,e+" "),this.index=r+e.length+1}getText(){return this.quill.getText()}clear(){this.quill.setText("")}isBlur(){return this.onBlur.asObservable()}}let y=(()=>{class t{constructor(t){this.state=t}transform(t,e){var i=e.text,n=e.name;if(!t||!i)return t.length>0?"behavior"==n?this.state.setCurrentBehaviorWord(t[0].value):"constraint"==n&&this.state.setCurrentConstraintWord(t[0].value):"behavior"==n?this.state.setCurrentBehaviorWord(""):"constraint"==n&&this.state.setCurrentConstraintWord(""),t;if(""===i.trim())return t.length>0?"behavior"==n?this.state.setCurrentBehaviorWord(t[0].value):"constraint"==n&&this.state.setCurrentConstraintWord(t[0].value):"behavior"==n?this.state.setCurrentBehaviorWord(""):"constraint"==n&&this.state.setCurrentConstraintWord(""),t;var s=t.filter(t=>t.value.trim().toLowerCase().indexOf(i.trim().toLowerCase())>-1);return s.length>0?"behavior"==n?this.state.setCurrentBehaviorWord(s[0].value):"constraint"==n&&this.state.setCurrentConstraintWord(s[0].value):"behavior"==n?this.state.setCurrentBehaviorWord(""):"constraint"==n&&this.state.setCurrentConstraintWord(""),s}}return t.\u0275fac=function(e){return new(e||t)(v.Y36(x.b,16))},t.\u0275pipe=v.Yjl({name:"textfilter",type:t,pure:!1}),t})();function _(t,e){if(1&t){const t=v.EpF();v.TgZ(0,"button",19),v.NdJ("click",function(){const e=v.CHM(t).$implicit;return v.oxw(2).insertValue(e.value)}),v._uU(1),v.qZA()}if(2&t){const t=e.$implicit;v.Q6J("disabled",t.flag),v.xp6(1),v.Oqu(t.value)}}function B(t,e){if(1&t&&(v.TgZ(0,"button",20),v._uU(1),v.qZA()),2&t){const t=v.oxw(2);v.Q6J("disabled",!0),v.xp6(1),v.Oqu(t.suggestionbehaviorMessage)}}function k(t,e){if(1&t&&(v.TgZ(0,"div",16),v.TgZ(1,"span"),v._uU(2,"Suggestions:"),v.qZA(),v.YNc(3,_,2,2,"button",17),v.ALo(4,"textfilter"),v.ALo(5,"slice"),v.YNc(6,B,2,2,"button",18),v.qZA()),2&t){const t=v.oxw();v.Q6J("hidden",!t.isEnable(2)),v.xp6(3),v.Q6J("ngForOf",v.xi3(4,3,v.Dn7(5,6,t.behaviorWordList,0,3),t.behaviorTextFilter)),v.xp6(3),v.Q6J("ngIf",null!=t.suggestionbehaviorMessage)}}function O(t,e){if(1&t){const t=v.EpF();v.TgZ(0,"button",22),v.NdJ("click",function(){const e=v.CHM(t).$implicit;return v.oxw(2).insertValueInConstraint(e.value)}),v._uU(1),v.qZA()}if(2&t){const t=e.$implicit;v.xp6(1),v.Oqu(t.value)}}function S(t,e){if(1&t&&(v.TgZ(0,"button",20),v._uU(1),v.qZA()),2&t){const t=v.oxw(2);v.Q6J("disabled",!0),v.xp6(1),v.Oqu(t.suggestionConstraintMessage)}}function N(t,e){if(1&t&&(v.TgZ(0,"div",16),v.TgZ(1,"span"),v._uU(2,"Suggestions:"),v.qZA(),v.YNc(3,O,2,1,"button",21),v.ALo(4,"textfilter"),v.ALo(5,"slice"),v.YNc(6,S,2,2,"button",18),v.qZA()),2&t){const t=v.oxw();v.Q6J("hidden",!t.isEnable(3)),v.xp6(3),v.Q6J("ngForOf",v.xi3(4,3,v.Dn7(5,6,t.constraintWordList,0,3),t.constraintTextFilter)),v.xp6(3),v.Q6J("ngIf",null!=t.suggestionConstraintMessage)}}function J(t,e){1&t&&(v.TgZ(0,"div",23),v.TgZ(1,"span"),v.TgZ(2,"i"),v._uU(3,"No Bindings Needed"),v.qZA(),v.qZA(),v.qZA())}function E(t,e){if(1&t){const t=v.EpF();v.TgZ(0,"li"),v.TgZ(1,"div"),v.TgZ(2,"mat-form-field",26),v.TgZ(3,"mat-label"),v._uU(4),v.qZA(),v.TgZ(5,"input",27),v.NdJ("ngModelChange",function(e){return v.CHM(t).$implicit.value=e})("change",function(){return v.CHM(t),v.oxw(2).storeBinding()}),v.qZA(),v.qZA(),v._UZ(6,"span"),v.qZA(),v.qZA()}if(2&t){const t=e.$implicit,i=v.oxw(2);v.xp6(4),v.Oqu(t.key+" represents: "),v.xp6(1),v.Q6J("disabled",i.onlyReadable())("ngModel",t.value)}}function I(t,e){if(1&t&&(v.TgZ(0,"div"),v.TgZ(1,"ul",24),v.YNc(2,E,7,3,"li",25),v.qZA(),v.qZA()),2&t){const t=v.oxw();v.xp6(2),v.Q6J("ngForOf",t.bindingList)}}function F(t,e){if(1&t){const t=v.EpF();v.TgZ(0,"div",0),v.TgZ(1,"div",28),v.TgZ(2,"div",29),v.TgZ(3,"button",30),v.NdJ("click",function(){return v.CHM(t),v.oxw().addBindings()}),v._uU(4,"Generate Ns File"),v.qZA(),v.qZA(),v.qZA(),v.qZA()}}function P(t,e){1&t&&(v.TgZ(0,"div",23),v.TgZ(1,"span"),v.TgZ(2,"i"),v._uU(3,"No Actors"),v.qZA(),v.qZA(),v.qZA())}function U(t,e){if(1&t&&(v.TgZ(0,"div",33),v.TgZ(1,"span"),v._uU(2),v.qZA(),v.qZA()),2&t){const t=e.$implicit;v.xp6(2),v.hij(" ",t.text," ")}}function Y(t,e){if(1&t&&(v.TgZ(0,"div",31),v.YNc(1,U,3,1,"div",32),v.qZA()),2&t){const t=v.oxw();v.xp6(1),v.Q6J("ngForOf",t.actorsList)}}function Q(t,e){1&t&&(v.TgZ(0,"div",23),v.TgZ(1,"span"),v.TgZ(2,"i"),v._uU(3,"No Bindings Needed."),v.qZA(),v.qZA(),v.qZA())}function D(t,e){1&t&&v._UZ(0,"i",38)}function W(t,e){1&t&&v._UZ(0,"i",39)}function R(t,e){if(1&t&&(v.TgZ(0,"div",35),v.TgZ(1,"span"),v._uU(2),v.qZA(),v.YNc(3,D,1,0,"i",36),v.YNc(4,W,1,0,"i",37),v.qZA()),2&t){const t=e.$implicit,i=v.oxw(2);v.xp6(2),v.hij(" ",t.key," "),v.xp6(1),v.Q6J("ngIf",i.isEmpty(t)),v.xp6(1),v.Q6J("ngIf",!i.isEmpty(t))}}function X(t,e){if(1&t&&(v.TgZ(0,"div",31),v.YNc(1,R,5,3,"div",34),v.qZA()),2&t){const t=v.oxw();v.xp6(1),v.Q6J("ngForOf",t.bindingList)}}const $=function(){return{height:"400px",border:"none"}},H=function(){return{container:"#editor1"}},V=function(t){return{counter:t,toolbar:!1}};function j(t,e){1&t&&(v.TgZ(0,"div",9),v.TgZ(1,"span"),v.TgZ(2,"i"),v._uU(3,"No Bindings Needed"),v.qZA(),v.qZA(),v.qZA())}function z(t,e){if(1&t){const t=v.EpF();v.TgZ(0,"li",12),v.TgZ(1,"div"),v.TgZ(2,"mat-form-field",13),v.TgZ(3,"input",14),v.NdJ("ngModelChange",function(e){return v.CHM(t).$implicit.value=e}),v.qZA(),v.qZA(),v._UZ(4,"span"),v.qZA(),v.qZA()}if(2&t){const t=e.$implicit;v.xp6(3),v.s9C("placeholder",t.key+" represents: "),v.Q6J("ngModel",t.value)}}function K(t,e){if(1&t&&(v.TgZ(0,"div"),v.TgZ(1,"ul",10),v.YNc(2,z,5,2,"li",11),v.qZA(),v.qZA()),2&t){const t=v.oxw();v.xp6(2),v.Q6J("ngForOf",t.bindingList)}}const G=".behavior-list[_ngcontent-%COMP%]{margin:.1em;list-style:none;padding:0}.behavior-box[_ngcontent-%COMP%]{margin:.5em;border:1px solid #ccc;padding:.5em}.word-bubble[_ngcontent-%COMP%]{border:1px dotted black;border-radius:1em;padding:.4em;margin:.1em;cursor:pointer}.binding-word-bubble[_ngcontent-%COMP%]{border:1px solid black;float:left;margin:2px;border-radius:8px;padding:3px}.word-bubble-button[_ngcontent-%COMP%]{border-radius:1em;padding:.4em;margin:.1em}.float-left[_ngcontent-%COMP%]{float:left}.actions[_ngcontent-%COMP%]{float:right;cursor:pointer;display:none}.behavior-list[_ngcontent-%COMP%]:hover   .actions[_ngcontent-%COMP%]{display:block}.disabled[_ngcontent-%COMP%]{pointer-events:none}.grabbable[_ngcontent-%COMP%]{cursor:move;cursor:grab;cursor:-webkit-grab}.grabbable[_ngcontent-%COMP%]:active{cursor:grabbing;cursor:-webkit-grabbing}.mat-radio-button[_ngcontent-%COMP%] ~ .mat-radio-button[_ngcontent-%COMP%]{margin-left:16px}.padding-left-right[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.button-padding[_ngcontent-%COMP%]{margin-left:.1em}.expand[_ngcontent-%COMP%]{float:right;cursor:pointer}.hide[_ngcontent-%COMP%]{display:none}";M.register("modules/counter",L);let tt=(()=>{class t{constructor(t,e,i,n,s){this.http=t,this.dialog=e,this.stateservice=i,this._snackBar=n,this.changeDetection=s,this.actorTextFilter="",this.behaviorTextFilter={name:"behavior",text:""},this.constraintTextFilter={name:"constraint",text:""},this.behaviorList=[],this.constraintWordList=[],this.actorsList=[],this.contraintList=[],this.bindingList=[],this.bindingMap=new Map,this.behaviorWordList=[],this.inputText="",this.actors="",this.selectedIndex=0}onlyReadable(){return"read"==this.tokenLevel}ngOnInit(){this.bindingMap=new Map,this.behaviorList=[];const t=this;this.tokenLevel=this.stateservice.getTokenLevel(),this.stateservice.getBehavior().subscribe(e=>{if(null!=e){var i="";e.forEach(t=>{i+=t+"<br>"}),t.behaviorText=i}}),this.stateservice.getBindings().subscribe(t=>{null!=t&&(this.bindingList=[],this.bindingMap=new Map,t.forEach(t=>{var e=t.trim().split(" "),i=e[0],n=e.splice(1),s={key:i,value:n=n.join(" ")};this.bindingMap.set(i,s),this.bindingList.push(s)}))}),this.stateservice.getActors().subscribe(e=>{null!=e&&(t.actorsList=[],e.forEach(t=>{this.actorsList.push({text:t})}))}),this.stateservice.getConstraints().subscribe(e=>{if(null!=e){var i="";e.forEach(t=>{i+=t+"<br>"}),t.constraintText=i}})}drop(t,e){(0,c.bA)(e,t.previousIndex,t.currentIndex)}created(t,e){var i=this;switch(e){case 1:this.actorService=t.getModule("counter");break;case 2:this.behaviorService=t.getModule("counter"),this.behaviorService.isBlur().subscribe(t=>{t&&i.behaviorService.isTextChanged()&&this.updateActors(),this.textBoxId=t?-1:2}),this.behaviorService.isEnterPressed().subscribe(t=>{if(t&&i.behaviorService.isTextChanged()){if(""===this.behaviorService.getText().trim())return;var e=this.behaviorService.getText().length-2;"\n"==this.behaviorService.getText().charAt(e)&&this.updateActors()}}),this.behaviorService.isTabPressed().subscribe(t=>{t&&""!=this.stateservice.getCurrentBehaviorWord().trim()&&this.insertValue(this.stateservice.getCurrentBehaviorWord(),!0)}),this.behaviorService.getSuggestionData().subscribe(t=>{if(null!=t){var e={type:"behavior",suggestion_for:t.currentSentence,behaviors:t.remainingSentences,constraints:[],actors:[]},i=this.constraintService.getText().trim();if(""!=i){var n=i.split("\n");e.constraints=n}this.behaviorTextFilter.text="",this.http.put("v1/pr/hlb/suggestions",e,{withCredential:!0}).subscribe(t=>{var e=[];t.suggestions.forEach(t=>{e.push({value:t,flag:!1})}),this.suggestionbehaviorMessage=""!=t.suggestion_text.trim()?t.suggestion_text:null,this.behaviorWordList=e,this.changeDetection.detectChanges()})}}),this.behaviorService.getCurrentWord().subscribe(t=>{null!=t&&t.trim()&&(this.behaviorTextFilter.text=t)});break;case 3:this.constraintService=t.getModule("counter"),this.constraintService.isBlur().subscribe(t=>{t&&i.constraintService.isTextChanged()&&this.updateActorsConstraint(),this.textBoxId=t?-1:3}),this.constraintService.isEnterPressed().subscribe(t=>{if(t&&i.constraintService.isTextChanged()){if(""===this.constraintService.getText().trim())return;var e=this.constraintService.getText().length-2;"\n"==this.constraintService.getText().charAt(e)&&this.updateActorsConstraint()}}),this.constraintService.isTabPressed().subscribe(t=>{t&&""!=this.stateservice.getCurrentConstraintWord().trim()&&this.insertValueInConstraint(this.stateservice.getCurrentConstraintWord(),!0)}),this.constraintService.getSuggestionData().subscribe(t=>{if(console.log("Blah!!"),null!=t){var e={type:"constraint",suggestion_for:t.currentSentence,behaviors:[],constraints:t.remainingSentences,actors:[]},i=this.behaviorService.getText().trim();if(""!=i){var n=i.split("\n");e.behaviors=n}this.constraintTextFilter.text="",this.http.put("v1/pr/hlb/suggestions",e,{withCredential:!0}).subscribe(t=>{var e=[];t.suggestions.forEach(t=>{e.push({value:t,flag:!1})}),this.suggestionConstraintMessage=""!=t.suggestion_text.trim()?t.suggestion_text:null,this.constraintWordList=e,this.changeDetection.detectChanges()})}}),this.constraintService.getCurrentWord().subscribe(t=>{null!=t&&t.trim()&&(this.constraintTextFilter.text=t)})}}updateActors(){if(""!==this.behaviorService.getText().trim()){var t={ParseType:"bash",Scenario:[],Constraints:[]};this.behaviorList=[],this.behaviorService.getText().trim().split("\n").forEach(e=>{var i=e.trim();""!=i&&(t.Scenario.push(i),this.behaviorList.push(i))}),this.stateservice.setBehavior(this.behaviorList),this.http.put("v1/pr/hlb/parse",t,{withCredential:!0}).subscribe(t=>{this.extractInfo(t)})}else this.actorsList=[]}updateActorsConstraint(){if(""!==this.constraintService.getText().trim()){var t={ParseType:"bash",Scenario:[],Constraints:[]};this.contraintList=[],this.constraintService.getText().trim().split("\n").forEach(e=>{var i=e.trim();""!=i&&(t.Constraints.push(i),this.contraintList.push(i))}),this.stateservice.setConstraints(this.contraintList),this.http.put("v1/pr/hlb/parse",t,{withCredential:!0}).subscribe(t=>{})}else this.actorsList=[]}extractInfo(t){this.extractScenario(t.parsedScenario)}onBlurMethod(){}extractScenario(t){this.actorsList=[],this.bindingList=[];var e=[];t.forEach(t=>{this.extractActors(null!=t[1]?t[1]:[]),null!=t[0]&&t[0].map(t=>{e.includes(t)||e.push(t)}),null!=t[2]&&t[2].map(t=>{e.includes(t)||e.push(t)}),null!=t[3]&&t[3].map(t=>{e.includes(t)||e.push(t)})}),this.extractEvents(e),this.changeDetection.detectChanges()}isEmpty(t){return null==t.value||""==t.value.trim()}loadBindings(){this.bindingMap.forEach((t,e)=>{this.bindingList.push(e)})}extractEvents(t){null!=t&&t.forEach(t=>{if(this.bindingMap.has(t))this.bindingList.push(this.bindingMap.get(t));else{var e={key:t,value:""};this.bindingMap.set(t,e),this.bindingList.push(e)}})}logChangeBehavior(t){this.behaviorService.getText().trim()}logChangeConstraints(t){this.constraintService.getText().trim()}insertValue(t,e=!1){this.service.insertValue(t,e,this.behaviorTextFilter.text)}insertValueInConstraint(t,e=!1){this.service.insertValue(t,e,this.constraintTextFilter.text)}selectTextBox(t){switch(this.textBoxId=t,t){case 1:this.service=this.actorService;break;case 2:this.service=this.behaviorService;break;case 3:this.service=this.constraintService}}isEnable(t){return this.textBoxId==t}extractActors(t){t.forEach(t=>{this.insertActor(t)});var e=[];this.actorsList.forEach(t=>{e.push(t.text)}),this.stateservice.setActors(e)}insertActor(t){null==this.actorsList.find(function(e){return e.text===t})&&this.actorsList.push({text:t})}clear(){this.service.clear(),this.behaviorText=""}selectedTab(t){this.selectedIndex=t}addBindings(){this.dialog.open(et,{width:"70%",data:this.bindingList}).afterClosed().subscribe(t=>{this.generateNs()})}generateNs(){var t={actors:[],behaviors:[],constraints:[],bindings:[]};if(0!=this.actorsList.length&&0!=this.behaviorList.length){this.actorsList.forEach(e=>{t.actors.push(e.text)});var e=!1;this.behaviorList.forEach(e=>{t.behaviors.push(e)}),this.contraintList.forEach(e=>{t.constraints.push(e.text)}),this.bindingList.forEach(i=>{null!=i.value&&""!=i.value.trim()?t.bindings.push(i.key+" "+i.value):e=!0}),!e&&(this.stateservice.enableLoader(),this.http.put("v1/pr/hlb/generateNs",t,{withCredential:!0}).subscribe(t=>{this.stateservice.disableLoader(),this.downLoadFile(t.script),this._snackBar.open("Successfully Downloaded.","close",{duration:2e3})},t=>{this.stateservice.disableLoader(),this._snackBar.open(t,"close",{duration:2e3})}))}}storeBinding(){var t=[];this.bindingList.forEach(e=>{t.push(e.key.trim()+" "+e.value.trim())}),this.stateservice.setBindings(t)}downLoadFile(t){var e=new Blob([t],{type:"text/plain"}),i="experiment.txt";if("msSaveOrOpenBlob"in navigator)navigator.msSaveOrOpenBlob(e,i);else{var n=document.createElement("a");n.download=i,n.innerHTML="Download File",n.href=window.URL.createObjectURL(e),n.style.display="none",document.body.appendChild(n),n.click()}}}return t.\u0275fac=function(e){return new(e||t)(v.Y36(m.O),v.Y36(g.uw),v.Y36(x.b),v.Y36(h.ux),v.Y36(v.sBO))},t.\u0275cmp=v.Xpm({type:t,selectors:[["hlb"]],decls:50,vars:25,consts:[[1,"row"],[1,"col-md-9"],[1,"row",2,"margin",".5em"],[1,"col-md-12",2,"padding","0"],[2,"text-align","center"],[1,"col-md-12",3,"click"],["style","margin: .6em;border-bottom: 1px solid #eee;",3,"hidden",4,"ngIf"],[1,"flex-container",3,"blur"],[3,"disabled","styles","modules","ngModel","ngModelChange","onContentChanged","onEditorCreated"],[1,"flex-container"],["style","font-size: .8em;text-align: center;",4,"ngIf"],[4,"ngIf"],[1,"col-md-3",2,"margin-top",".5em"],["class","row",4,"ngIf"],[1,"row",2,"margin-top",".1em","margin-bottom",".1em"],["style","  height: auto;\n            display: flow-root;\n            padding: 0;",4,"ngIf"],[2,"margin",".6em","border-bottom","1px solid #eee",3,"hidden"],["type","button","class","btn btn-outline-primary word-bubble-button",3,"disabled","click",4,"ngFor","ngForOf"],["type","button","class","btn btn-outline-primary word-bubble-button",3,"disabled",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","word-bubble-button",3,"disabled","click"],["type","button",1,"btn","btn-outline-primary","word-bubble-button",3,"disabled"],["type","button","class","btn btn-outline-primary word-bubble-button",3,"click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-primary","word-bubble-button",3,"click"],[2,"font-size",".8em","text-align","center"],[1,"behavior-list"],[4,"ngFor","ngForOf"],["appearance","outline",2,"width","100%"],["matInput","",3,"disabled","ngModel","ngModelChange","change"],[1,"col-md-12",2,"padding","1em"],[2,"text-align","center","padding",".1em"],["mat-stroked-button","",3,"click"],[2,"height","auto","display","flow-root","padding","0"],["class","binding-word-bubble","style","  border: 1px solid black;",4,"ngFor","ngForOf"],[1,"binding-word-bubble",2,"border","1px solid black"],["class","binding-word-bubble",4,"ngFor","ngForOf"],[1,"binding-word-bubble"],["class","fas fa-exclamation-circle","style","color: red;",4,"ngIf"],["class","fa fa-check-circle","style","color: green;",4,"ngIf"],[1,"fas","fa-exclamation-circle",2,"color","red"],[1,"fa","fa-check-circle",2,"color","green"]],template:function(t,e){1&t&&(v.TgZ(0,"div",0),v.TgZ(1,"div",1),v.TgZ(2,"div",2),v.TgZ(3,"div",3),v.TgZ(4,"mat-card"),v.TgZ(5,"div",4),v._uU(6," Behavior"),v.qZA(),v._UZ(7,"hr"),v.TgZ(8,"div",0),v.TgZ(9,"div",5),v.NdJ("click",function(){return e.selectTextBox(2)}),v.YNc(10,k,7,10,"div",6),v.TgZ(11,"div",7),v.NdJ("blur",function(){return e.onBlurMethod()}),v.TgZ(12,"quill-editor",8),v.NdJ("ngModelChange",function(t){return e.behaviorText=t})("onContentChanged",function(t){return e.logChangeBehavior(t)})("onEditorCreated",function(t){return e.created(t,2)}),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.TgZ(13,"div",2),v.TgZ(14,"div",3),v.TgZ(15,"mat-card"),v.TgZ(16,"div",4),v._uU(17," Constraints"),v.qZA(),v._UZ(18,"hr"),v.TgZ(19,"div",0),v.TgZ(20,"div",5),v.NdJ("click",function(){return e.selectTextBox(3)}),v.YNc(21,N,7,10,"div",6),v.TgZ(22,"div",9),v.TgZ(23,"quill-editor",8),v.NdJ("ngModelChange",function(t){return e.constraintText=t})("onContentChanged",function(t){return e.logChangeConstraints(t)})("onEditorCreated",function(t){return e.created(t,3)}),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.TgZ(24,"div",2),v.TgZ(25,"div",3),v.TgZ(26,"mat-card"),v.TgZ(27,"div",4),v._uU(28," Bindings"),v.qZA(),v._UZ(29,"hr"),v.YNc(30,J,4,0,"div",10),v.YNc(31,I,3,1,"div",11),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.TgZ(32,"div",12),v.YNc(33,F,5,0,"div",13),v.TgZ(34,"div",14),v.TgZ(35,"div",3),v.TgZ(36,"mat-card"),v.TgZ(37,"div",4),v._uU(38,"Actors "),v.qZA(),v._UZ(39,"hr"),v.YNc(40,P,4,0,"div",10),v.YNc(41,Y,2,1,"div",15),v.qZA(),v.qZA(),v.qZA(),v.TgZ(42,"div",14),v.TgZ(43,"div",3),v.TgZ(44,"mat-card"),v.TgZ(45,"div",4),v._uU(46,"Bindings Needed "),v.qZA(),v._UZ(47,"hr"),v.YNc(48,Q,4,0,"div",10),v.YNc(49,X,2,1,"div",15),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA()),2&t&&(v.xp6(10),v.Q6J("ngIf",!e.onlyReadable()),v.xp6(2),v.Q6J("disabled",e.onlyReadable())("styles",v.DdM(17,$))("modules",v.VKq(19,V,v.DdM(18,H)))("ngModel",e.behaviorText),v.xp6(9),v.Q6J("ngIf",!e.onlyReadable()),v.xp6(2),v.Q6J("disabled",e.onlyReadable())("styles",v.DdM(21,$))("modules",v.VKq(23,V,v.DdM(22,H)))("ngModel",e.constraintText),v.xp6(7),v.Q6J("ngIf",0==e.bindingList.length),v.xp6(1),v.Q6J("ngIf",0!=e.bindingList.length),v.xp6(2),v.Q6J("ngIf",!e.onlyReadable()),v.xp6(7),v.Q6J("ngIf",0==e.actorsList.length),v.xp6(1),v.Q6J("ngIf",0!=e.actorsList.length),v.xp6(7),v.Q6J("ngIf",0==e.bindingList.length),v.xp6(1),v.Q6J("ngIf",0!=e.bindingList.length))},directives:[a.a8,T.O5,l.g6,s.JJ,s.On,T.sg,C.KE,C.hX,o.Nt,s.Fj,u.lW],pipes:[y,T.OU],styles:[G]}),t})(),et=(()=>{class t{constructor(t,e){this.dialogRef=t,this.bindingList=e}onNoClick(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(v.Y36(g.so),v.Y36(g.WI))},t.\u0275cmp=v.Xpm({type:t,selectors:[["hlb-binding"]],decls:13,vars:3,consts:[["mat-dialog-content",""],[1,"row",2,"margin",".5em"],[1,"col-md-12"],[2,"text-align","center"],["style","font-size: .8em;text-align: center;",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],[2,"font-size",".8em","text-align","center"],[1,"behavior-list"],["class","binding-box",4,"ngFor","ngForOf"],[1,"binding-box"],[2,"width","100%"],["matInput","",3,"placeholder","ngModel","ngModelChange"]],template:function(t,e){1&t&&(v.TgZ(0,"div",0),v.TgZ(1,"div",1),v.TgZ(2,"div",2),v.TgZ(3,"div",3),v._uU(4," Bindings"),v.qZA(),v._UZ(5,"hr"),v.YNc(6,j,4,0,"div",4),v.YNc(7,K,3,1,"div",5),v.qZA(),v.qZA(),v.qZA(),v.TgZ(8,"div",6),v.TgZ(9,"button",7),v.NdJ("click",function(){return e.onNoClick()}),v._uU(10,"Back"),v.qZA(),v.TgZ(11,"button",8),v._uU(12,"Download"),v.qZA(),v.qZA()),2&t&&(v.xp6(6),v.Q6J("ngIf",0==e.bindingList.length),v.xp6(1),v.Q6J("ngIf",0!=e.bindingList.length),v.xp6(4),v.Q6J("mat-dialog-close",e.bindingList))},directives:[g.xY,T.O5,g.H8,u.lW,g.ZT,T.sg,C.KE,o.Nt,s.Fj,s.JJ,s.On],styles:[G]}),t})();const it=function(){return{height:"100px"}},nt=function(){return{container:"#editor1"}},st=function(t){return{counter:t,toolbar:!1}};M.register("modules/counter",L);let rt=(()=>{class t{constructor(t,e,i){this.http=t,this.stateservice=e,this._snackBar=i,this.nlpTextFilter="",this.nlpText="",this.behaviorList=[],this.wordlist=[]}created(t){this.nlpText="",this.service=t.getModule("counter")}logChange(t,e){if(""!==this.service.getText().trim()){var i=this.service.getText().split(/\s/);this.nlpTextFilter=i[i.length-2]}}insertValue(t){this.service.insertValue(t)}delete(t){this.behaviorList.splice(t,1)}save(){var t={text:this.service.getText().trim()};this.stateservice.enableLoader(),this.http.put("v1/pr/nlp/behavior",t,{withCredential:!0}).subscribe(t=>{console.log(t),this.stateservice.disableLoader(),this.stateservice.setBehavior(t.behavior),this.stateservice.setActors(t.actors),this.stateservice.setConstraints(t.constraints),this._snackBar.open("Successfully Translated.","close",{duration:2e3})},t=>{this.stateservice.disableLoader(),this._snackBar.open(t,"close",{duration:2e3})})}updateWordList(){this.localWordList=[];var t=new Map;this.behaviorList.forEach(e=>{e.text.trim().split(/\s/).forEach(e=>{""!==e.trim()&&(t.has(e.trim())||(this.localWordList.push({value:e.trim()}),t.set(e.trim(),!0)))})}),this.wordlist=this.wordlist.concat(this.localWordList)}}return t.\u0275fac=function(e){return new(e||t)(v.Y36(m.O),v.Y36(x.b),v.Y36(h.ux))},t.\u0275cmp=v.Xpm({type:t,selectors:[["nlp"]],decls:8,vars:7,consts:[[1,"row"],[1,"col-md-12",2,"padding","2em"],[1,"flex-container"],[3,"styles","modules","ngModel","ngModelChange","onContentChanged","onEditorCreated"],[1,"col-md-12"],[2,"float","right"],["mat-stroked-button","",3,"click"]],template:function(t,e){1&t&&(v.TgZ(0,"div",0),v.TgZ(1,"div",1),v.TgZ(2,"div",2),v.TgZ(3,"quill-editor",3),v.NdJ("ngModelChange",function(t){return e.nlpText=t})("onContentChanged",function(t){return e.logChange(t,1)})("onEditorCreated",function(t){return e.created(t)}),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.TgZ(4,"div",4),v.TgZ(5,"div",5),v.TgZ(6,"button",6),v.NdJ("click",function(){return e.save()}),v._uU(7,"Generate HLB"),v.qZA(),v.qZA(),v.qZA()),2&t&&(v.xp6(3),v.Q6J("styles",v.DdM(3,it))("modules",v.VKq(5,st,v.DdM(4,nt)))("ngModel",e.nlpText))},directives:[l.g6,s.JJ,s.On,u.lW],styles:[".behavior-list[_ngcontent-%COMP%]{margin:.1em;list-style:none;padding:0}.behavior-box[_ngcontent-%COMP%]{margin:.5em;border:1px solid #ccc;padding:.5em}.word-bubble[_ngcontent-%COMP%]{border:1px dotted black;border-radius:1em;padding:.4em;margin:.1em;cursor:pointer}.word-bubble-button[_ngcontent-%COMP%]{border-radius:1em;padding:.4em;margin:.1em;cursor:pointer}.float-left[_ngcontent-%COMP%]{float:left}.actions[_ngcontent-%COMP%]{float:right}.disabled[_ngcontent-%COMP%]{pointer-events:none;background-color:gray}"]}),t})();var ot=i(88170);const at=function(){return[500,700]},ct=function(){return{id:"a",source:"first",target:"second",label:"is parent of"}},lt=function(){return{id:"b",source:"first",target:"third",label:"is parent of"}},dt=function(){return{id:"c",source:"fourth",target:"first",label:"is parent of"}},ut=function(){return{id:"d",source:"fourth",target:"third",label:"is parent of"}},ht=function(){return{id:"e",source:"fourth",target:"second",label:"is parent of"}},gt=function(){return{id:"f",source:"fourth",target:"fifth",label:"is parent of"}},bt=function(t,e,i,n,s,r){return[t,e,i,n,s,r]},pt=function(){return{id:"first",label:"A"}},vt=function(){return{id:"second",label:"B"}},ft=function(){return{id:"third",label:"C"}},mt=function(){return{id:"fourth",label:"D"}},xt=function(){return{id:"fifth",label:"E"}},Zt=function(){return{id:"six",label:"F"}};let Tt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=v.Xpm({type:t,selectors:[["dependency-graph"]],decls:3,vars:30,consts:[[1,"row"],[1,"col-md-12",2,"background-color","grey"],[1,"chart-container",3,"view","links","nodes"]],template:function(t,e){1&t&&(v.TgZ(0,"div",0),v.TgZ(1,"div",1),v._UZ(2,"ngx-graph",2),v.qZA(),v.qZA()),2&t&&(v.xp6(2),v.Q6J("view",v.DdM(3,at))("links",v.HTZ(10,bt,v.DdM(4,ct),v.DdM(5,lt),v.DdM(6,dt),v.DdM(7,ut),v.DdM(8,ht),v.DdM(9,gt)))("nodes",v.HTZ(23,bt,v.DdM(17,pt),v.DdM(18,vt),v.DdM(19,ft),v.DdM(20,mt),v.DdM(21,xt),v.DdM(22,Zt))))},directives:[ot.B$],styles:[".chart-container[_ngcontent-%COMP%]{width:100%;height:100%;background-color:gray}"]}),t})();function Ct(t,e){if(1&t&&(v.TgZ(0,"div",3),v._UZ(1,"experiment-info",4),v.qZA()),2&t){const t=v.oxw(2);v.xp6(1),v.Q6J("id",t.experimentId)}}function At(t,e){1&t&&(v.TgZ(0,"div",3),v._UZ(1,"hlb"),v.qZA())}function qt(t,e){1&t&&(v.TgZ(0,"div",3),v._UZ(1,"nlp"),v.qZA())}function Mt(t,e){1&t&&(v.TgZ(0,"div",3),v._UZ(1,"dependency-graph"),v.qZA())}function wt(t,e){if(1&t&&(v.TgZ(0,"mat-tab",1),v.YNc(1,Ct,2,1,"div",2),v.YNc(2,At,2,0,"div",2),v.YNc(3,qt,2,0,"div",2),v.YNc(4,Mt,2,0,"div",2),v.qZA()),2&t){const t=e.$implicit;v.s9C("label",t.name),v.xp6(1),v.Q6J("ngIf",1==t.id),v.xp6(1),v.Q6J("ngIf",2==t.id),v.xp6(1),v.Q6J("ngIf",3==t.id),v.xp6(1),v.Q6J("ngIf",4==t.id)}}let Lt=(()=>{class t{constructor(t,e,i,n,s){this.route=t,this.router=e,this.http=i,this.state=n,this.auth=s,this.menuList=[],this.experimentId=-1}ngOnInit(){this.route.params.subscribe(t=>{""!=t.id&&(this.experimentId=t.id,this.state.enableLoader(),this.http.get("v1/pr/token-based-auth/get/"+this.experimentId,{withCredential:!0}).subscribe(t=>(null!=t.data&&null!=t.data.token&&t.data.status?this.http.get("v1/pr/token-based-auth/getdetails/"+this.experimentId,{withCredential:!0}).subscribe(e=>{var i=e.data;this.state.setActors(i.actors),this.state.setExperimentName(i.name),this.state.setExperimentDescription(i.description),this.state.setBehavior(i.behaviors),this.state.setBindings(i.bindings),this.state.setConstraints(i.constraints),this.state.setTokenLevel(t.data.level),this.setMenu(),this.state.disableLoader()},t=>{alert("Invalid Token"),this.router.navigate(["auth/login"])}):(alert("Invalid Token"),this.router.navigate(["auth/login"])),"")))})}setMenu(){this.menuList.push({name:"Information",id:1,html:"<experiment-info></experiment-info>"}),this.menuList.push({name:"HLB",id:2,html:"<hlb></hlb>"}),"write"==this.state.getTokenLevel()&&(this.menuList.push({name:"NLP",id:3,html:"<nlp></nlp>"}),this.menuList.push({name:"Behavior Dependency Graph",id:4,html:"<p>In Progress.....</p>"}),this.menuList.push({name:"Upload",id:5,html:"<upload></upload>"}))}}return t.\u0275fac=function(e){return new(e||t)(v.Y36(f.gz),v.Y36(f.F0),v.Y36(m.O),v.Y36(x.b),v.Y36(Z.e))},t.\u0275cmp=v.Xpm({type:t,selectors:[["hlbparser"]],decls:2,vars:1,consts:[[3,"label",4,"ngFor","ngForOf"],[3,"label"],["class","tab",4,"ngIf"],[1,"tab"],[3,"id"]],template:function(t,e){1&t&&(v.TgZ(0,"mat-tab-group"),v.YNc(1,wt,5,5,"mat-tab",0),v.qZA()),2&t&&(v.xp6(1),v.Q6J("ngForOf",e.menuList))},directives:[n.SP,T.sg,n.uX,T.O5,q,tt,rt,Tt],styles:[".tab[_ngcontent-%COMP%]{overflow:hidden}"]}),t})();const yt=[{path:"view/:id",canActivateChild:[i(589).a],component:Lt}];let _t=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=v.oAB({type:t}),t.\u0275inj=v.cJS({imports:[[f.Bz.forChild(yt)],f.Bz]}),t})();var Bt=i(82613);let kt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=v.oAB({type:t,bootstrap:[Lt]}),t.\u0275inj=v.cJS({providers:[x.b],imports:[[T.ez,f.Bz,Bt.Fk,ot.To,g.Is,u.ot,h.ZX,d.uH,n.Nh,c._t,s.u5,b.p0,r.To,a.QW,l.fi.forRoot(),_t,o.c,p.Yi]]}),t})()},9468:function(t,e,i){i.r(e),i.d(e,{PublicModule:function(){return h}});var n=i(95987),s=i(37716),r=i(42146);const o=[{path:"",component:(()=>{class t{constructor(){this.alive=!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-public"]],decls:2,vars:0,template:function(t,e){1&t&&(s.TgZ(0,"layout"),s._UZ(1,"router-outlet"),s.qZA())},directives:[r.$,n.lC],styles:[".container[_ngcontent-%COMP%]{margin:0}"]}),t})(),children:[{path:"hlb",loadChildren:()=>Promise.resolve().then(i.bind(i,65702)).then(t=>t.PublicHLBParserModule)},{path:"**",component:(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["error"]],decls:2,vars:0,template:function(t,e){1&t&&(s.TgZ(0,"h1"),s._uU(1," Public Error"),s.qZA())},encapsulation:2}),t})()}]}];let a=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[n.Bz.forChild(o)],n.Bz]}),t})();var c=i(65702),l=i(38583),d=i(36858),u=i(617);let h=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[a,l.ez,u.I,c.PublicHLBParserModule,d.fi.forRoot()]]}),t})()}}]);